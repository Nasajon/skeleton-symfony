version: '2'

services:
    app:
        image: nasajon/php:7.1-fpm-symfony-dev
        restart: always
        ports:
            - "80:80"
        volumes:
            - $PWD:/var/www/html        
        env_file:
            - common.env

    php-node:
        image: nasajon/php-node
        volumes:
              - ./:/var/www/html
        environment:
              - "NODE_ENV=production"
        working_dir: /var/www/html
        entrypoint: php vendor/nasajon/mdatransformer/bin/transformer nasajon:mda:builder --nocache -vvv --cleardir
        

    postgres:
       image: postgres:9.6
       ports:
         - "5432:5432"
       restart: always
       volumes:
           - $PWD/vendor/nasajon/bancosweb/dump:/docker-entrypoint-initdb.d/
       environment:
           - "POSTGRES_DB=integratto2"
           - "POSTGRES_USER=bancosweb"
           - "POSTGRES_PASSWORD=mysecretpassword"   